import{j as e,q as x,a as N,t as w,H as g,u as v,R as C,s as P}from"./ui-DQFPLK17.js";import{u as S,a as k,r as n}from"./vendor-CGaW2js3.js";import{c as b}from"./confetti.module-oQXWb4Lk.js";import{g as E,h as I}from"./index-BULVNrj6.js";import{g as D}from"./firebase-BCTgdpS7.js";const H=()=>{const[t]=S(),h=k(),[r,a]=n.useState("loading"),[i,s]=n.useState(""),[u,p]=n.useState("");n.useEffect(()=>{(async()=>{const d=t.get("status"),o=t.get("orderId"),f=t.get("message");if(d==="success"){a("success"),s("¬°Pago completado exitosamente!"),p(o||""),b({particleCount:100,spread:70,origin:{y:.6}});return}if(d==="failed"){a("failed"),s(f||"El pago no pudo ser procesado");return}if(d==="error"){a("error"),s(f||"Ocurri√≥ un error durante el proceso de pago");return}if(o)try{const m=D(),y=E(m,"us-central1"),l=await I(y,"verifyPowerTranzPayment")({orderId:o});l.data.success?(a("success"),s(l.data.message),p(l.data.transactionId||o),b({particleCount:100,spread:70,origin:{y:.6}})):(a("failed"),s(l.data.message))}catch(m){console.error("Verify payment error:",m),a("error"),s("No se pudo verificar el estado del pago")}else a("error"),s("No se recibi√≥ informaci√≥n del pago")})()},[t]);const c=()=>{h("/app/patient/dashboard")},j=()=>{h("/app/patient/dashboard")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center p-4",children:e.jsxs(x.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"w-full max-w-md bg-white rounded-3xl shadow-2xl p-8 text-center",children:[r==="loading"&&e.jsxs("div",{className:"py-12",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-10 h-10 text-blue-600 animate-spin"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verificando Pago"}),e.jsx("p",{className:"text-gray-500",children:"Por favor espere mientras confirmamos su transacci√≥n..."})]}),r==="success"&&e.jsxs(x.div,{initial:{scale:.8},animate:{scale:1},className:"py-6",children:[e.jsx(x.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,delay:.2},className:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center shadow-lg shadow-green-500/30",children:e.jsx(w,{className:"w-12 h-12 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"¬°Pago Exitoso!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:i}),u&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"ID de Transacci√≥n"}),e.jsx("p",{className:"text-sm font-mono font-bold text-gray-900 break-all",children:u})]}),e.jsx("div",{className:"bg-green-50 border border-green-100 rounded-xl p-4 mb-6",children:e.jsxs("p",{className:"text-sm text-green-700",children:["‚úì Su consulta ha sido confirmada",e.jsx("br",{}),"‚úì El chat con el m√©dico ha sido activado"]})}),e.jsxs("button",{onClick:c,className:"w-full py-4 bg-gradient-to-r from-teal-500 to-blue-600 text-white rounded-xl font-bold shadow-lg shadow-teal-500/30 hover:shadow-teal-500/50 transition-all flex items-center justify-center gap-2",children:[e.jsx(g,{size:20}),"Ir al Dashboard"]})]}),r==="failed"&&e.jsxs("div",{className:"py-6",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-red-400 to-rose-500 rounded-full flex items-center justify-center shadow-lg shadow-red-500/30",children:e.jsx(v,{className:"w-12 h-12 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Pago No Completado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:i}),e.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-xl p-4 mb-6",children:[e.jsx("p",{className:"text-sm text-red-700",children:"El pago no pudo ser procesado. Esto puede deberse a:"}),e.jsxs("ul",{className:"text-sm text-red-600 mt-2 text-left list-disc list-inside",children:[e.jsx("li",{children:"Fondos insuficientes"}),e.jsx("li",{children:"Tarjeta rechazada por el banco"}),e.jsx("li",{children:"Verificaci√≥n 3D Secure fallida"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:j,className:"w-full py-4 bg-gradient-to-r from-teal-500 to-blue-600 text-white rounded-xl font-bold shadow-lg shadow-teal-500/30 hover:shadow-teal-500/50 transition-all flex items-center justify-center gap-2",children:[e.jsx(C,{size:20}),"Intentar de Nuevo"]}),e.jsx("button",{onClick:c,className:"w-full py-3 text-gray-500 font-medium hover:bg-gray-50 rounded-xl transition-colors",children:"Volver al Dashboard"})]})]}),r==="error"&&e.jsxs("div",{className:"py-6",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center shadow-lg shadow-amber-500/30",children:e.jsx(P,{className:"w-12 h-12 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error de Verificaci√≥n"}),e.jsx("p",{className:"text-gray-600 mb-6",children:i}),e.jsx("div",{className:"bg-amber-50 border border-amber-100 rounded-xl p-4 mb-6",children:e.jsx("p",{className:"text-sm text-amber-700",children:"Si cree que su pago fue procesado, por favor contacte a soporte con el n√∫mero de su orden."})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:c,className:"w-full py-4 bg-gradient-to-r from-teal-500 to-blue-600 text-white rounded-xl font-bold shadow-lg shadow-teal-500/30 hover:shadow-teal-500/50 transition-all flex items-center justify-center gap-2",children:[e.jsx(g,{size:20}),"Ir al Dashboard"]}),e.jsx("a",{href:"https://wa.me/50589776879",target:"_blank",rel:"noopener noreferrer",className:"block w-full py-3 text-green-600 font-medium hover:bg-green-50 rounded-xl transition-colors",children:"Contactar Soporte por WhatsApp"})]})]}),e.jsx("p",{className:"mt-6 text-[10px] text-gray-400 flex items-center justify-center gap-1",children:"üîí Transacci√≥n protegida con encriptaci√≥n SSL"})]})})};export{H as PaymentCallbackScreen,H as default};
