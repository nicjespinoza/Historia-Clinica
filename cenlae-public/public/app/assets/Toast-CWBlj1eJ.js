const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FloatingLabelInput-ByVDsq9z.js","assets/index-CbcGWo8E.js","assets/ui-P4Dc-eHU.js","assets/vendor-DTmQ9CDn.js","assets/firebase-CSuzTyKx.js","assets/index-CJFUkV_I.css","assets/utils-CDN07tui.js"])))=>i.map(i=>d[i]);
import{a as Q,d as l,_ as R,s as X}from"./index-CbcGWo8E.js";import{a as w,d as f,b as T,c as m,e as I,u as D,q as A,l as L,o as O,w as E,f as b,s as Z,r as ee,h as te,i as ae}from"./firebase-CSuzTyKx.js";import{j as t,O as q,q as $,V as se,Q as ie,X as k,U as re,Y as oe,_ as ne,R as ce,C as le,$ as de,a0 as ue,t as me}from"./ui-P4Dc-eHU.js";import{r as j}from"./vendor-DTmQ9CDn.js";import{F as g}from"./FloatingLabelInput-ByVDsq9z.js";const M=async e=>{try{const a=Q.currentUser;let s="unknown",r="unknown";if(a){r=a.email||"no-email";try{const i=await w(f(l,"users",a.uid));i.exists()&&(s=i.data().role||"unknown")}catch{}}await T(m(l,"auditLogs"),{...e,userId:(a==null?void 0:a.uid)||"anonymous",userEmail:r,userRole:s,timestamp:new Date().toISOString(),userAgent:navigator.userAgent})}catch(a){console.error("Failed to write audit log:",a)}};class pe{constructor(){this.cache=new Map,this.defaultTTL=300*1e3}async getOrFetch(a,s,r=this.defaultTTL){const i=this.cache.get(a),c=Date.now();if(i&&c<i.expiresAt)return i.data;const n=await s();return this.cache.set(a,{data:n,timestamp:c,expiresAt:c+r}),n}invalidate(a){this.cache.delete(a)}invalidatePattern(a){const s=new RegExp(a);for(const r of this.cache.keys())s.test(r)&&this.cache.delete(r)}clear(){this.cache.clear()}getStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}const y=new pe,he={patients:20},ge={maxWidth:1920,maxHeight:1080,quality:.8,format:"webp"},be=async(e,a={})=>{const s={...ge,...a};return!e.type.startsWith("image/")||e.size<100*1024?e:new Promise((r,i)=>{const c=new Image,n=document.createElement("canvas"),u=n.getContext("2d");c.onload=()=>{let{width:p,height:o}=c;const d=s.maxWidth,x=s.maxHeight;if(p>d||o>x){const v=Math.min(d/p,x/o);p=Math.round(p*v),o=Math.round(o*v)}n.width=p,n.height=o,u==null||u.drawImage(c,0,0,p,o),n.toBlob(v=>{if(v){const N=new File([v],e.name.replace(/\.[^.]+$/,`.${s.format}`),{type:`image/${s.format}`});console.log(`ðŸ“¸ Image compressed: ${U(e.size)} â†’ ${U(N.size)} (${Math.round((1-N.size/e.size)*100)}% savings)`),r(N)}else i(new Error("Failed to compress image"))},`image/${s.format}`,s.quality)},c.onerror=()=>i(new Error("Failed to load image")),c.src=URL.createObjectURL(e)})},U=e=>e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`,Ee=(e,a)=>{let s=null;return(...r)=>{s&&clearTimeout(s),s=setTimeout(()=>e(...r),a)}},fe=e=>e&&typeof e=="object"&&typeof e.toDate=="function",z=e=>{if(!e||typeof e!="object")return e;if(fe(e))return e.toDate().toISOString();if(!Array.isArray(e)&&e.seconds!==void 0&&e.nanoseconds!==void 0&&Object.keys(e).length<=2)return new Date(e.seconds*1e3).toISOString();if(Array.isArray(e))return e.map(s=>z(s));const a={};return Object.keys(e).forEach(s=>{a[s]=z(e[s])}),a},h=e=>{const a=e.data(),s=z(a),{id:r,...i}=s;return{id:e.id,...i}},Se={getPatients:async()=>y.getOrFetch("patients:all_v3",async()=>{const e=A(m(l,"patients"),O("createdAt","desc"));return(await b(e)).docs.map(s=>h(s))},300*1e3),getPatientsPaginated:async(e=he.patients,a)=>{let s=A(m(l,"patients"),O("createdAt","desc"),L(e+1));a&&(s=A(m(l,"patients"),O("createdAt","desc"),Z(a),L(e+1)));const i=(await b(s)).docs,c=i.length>e,n=c?i.slice(0,-1):i;return{data:n.map(u=>h(u)),lastDoc:n[n.length-1]||null,hasMore:c,totalFetched:n.length}},createPatient:async e=>{const{id:a,...s}=e,r=await T(m(l,"patients"),{...s,createdAt:new Date().toISOString()});return y.invalidate("patients:all_v3"),await M({action:"CREATE_PATIENT",details:`Created patient ${s.firstName} ${s.lastName}`,targetId:r.id}),{id:r.id,...s}},updatePatient:async(e,a)=>{const s=f(l,"patients",e);await D(s,a),y.invalidate("patients:all_v3");const r=await w(s);return h(r)},deletePatient:async e=>{const a=f(l,"patients",e),s=["histories","consults","observations","snapshots"];for(const n of s){const u=await b(m(l,"patients",e,n));await R(()=>import("./firebase-CSuzTyKx.js").then(o=>o.Q),[]).then(o=>{const d=o.writeBatch(l);return u.docs.forEach(x=>d.delete(x.ref)),d.commit()})}const r=A(m(l,"appointments"),E("patientId","==",e)),i=await b(r);await R(()=>import("./firebase-CSuzTyKx.js").then(n=>n.Q),[]).then(n=>{const u=n.writeBatch(l);return i.docs.forEach(p=>u.delete(p.ref)),u.commit()}),await I(a),await I(a),y.invalidate("patients:all_v3"),y.invalidatePattern("^appointments:"),await M({action:"DELETE_PATIENT",details:`Deleted patient ${e} and all related data`,targetId:e})},getPatient:async e=>{const a=f(l,"patients",e),s=await w(a);return s.exists()?h(s):null},getPatientStatus:async e=>{const a=f(l,"patients",e),s=await w(a);if(!s.exists())return{canChat:!1};const r=s.data();return{canChat:(r==null?void 0:r.isOnline)??!1}},getHistories:async e=>{if(e){const r=m(l,"patients",e,"histories"),c=(await b(r)).docs.map(d=>h(d)),n=A(m(l,"initialHistories"),E("patientId","==",e)),p=(await b(n)).docs.map(d=>h(d));return[...c,...p].sort((d,x)=>new Date(x.date).getTime()-new Date(d.date).getTime())}const a=await b(m(l,"patients")),s=[];for(const r of a.docs){const i=await b(m(l,"patients",r.id,"histories"));s.push(...i.docs.map(c=>h(c)))}return s},createHistory:async e=>{const a=await T(m(l,"patients",e.patientId,"histories"),e);return await M({action:"CREATE_HISTORY",details:`Created history for patient ${e.patientId}`,targetId:a.id,metadata:{patientId:e.patientId}}),{id:a.id,...e}},updateHistory:async(e,a)=>{if(!a.patientId)throw new Error("patientId required to update history");try{const s=f(l,"patients",a.patientId,"histories",e);await D(s,a);const r=await w(s);return h(r)}catch{try{const r=f(l,"initialHistories",e);await D(r,a);const i=await w(r);return h(i)}catch{throw new Error("History not found in either location")}}},deleteHistory:async(e,a)=>{if(!a)throw new Error("Patient ID required for deletion");const s=f(l,"patients",a,"histories",e);if((await w(s)).exists()){await I(s);return}const i=f(l,"initialHistories",e);if((await w(i)).exists()){await I(i);return}},getConsult:async(e,a)=>{try{const s=f(l,"patients",e,"consults",a),r=await w(s);if(r.exists())return h(r)}catch(s){console.warn("Could not fetch from subcollection, checking root:",s.message)}try{const s=f(l,"subsequentConsults",a),r=await w(s);if(r.exists()){const i=h(r);if(i.patientId===e)return i}}catch(s){console.error("Error fetching from root collection:",s)}return null},getConsults:async e=>{if(e){const i=(await b(m(l,"patients",e,"consults"))).docs.map(o=>h(o)),c=A(m(l,"subsequentConsults"),E("patientId","==",e)),u=(await b(c)).docs.map(o=>h(o));return[...i,...u].sort((o,d)=>new Date(d.date).getTime()-new Date(o.date).getTime())}const a=await b(m(l,"patients")),s=[];for(const r of a.docs){const i=await b(m(l,"patients",r.id,"consults"));s.push(...i.docs.map(c=>h(c)))}return s},createConsult:async e=>{const a=await T(m(l,"patients",e.patientId,"consults"),e);return await M({action:"CREATE_CONSULT",details:`Created consult for patient ${e.patientId}`,targetId:a.id,metadata:{patientId:e.patientId}}),{id:a.id,...e}},createObservation:async(e,a)=>({id:(await T(m(l,"patients",e,"observations"),{...a,createdAt:new Date().toISOString()})).id,...a}),getObservations:async(e,a)=>{const s=m(l,"patients",e,"observations");let r;if(a){const i=A(s,E("snapshotId","==",a));r=await b(i)}else r=await b(s);return r.docs.map(i=>h(i))},deleteObservation:async(e,a)=>(await I(f(l,"patients",e,"observations",a)),{success:!0}),createSnapshot:async(e,a)=>({id:(await T(m(l,"patients",e,"snapshots"),{name:a||`Snapshot ${new Date().toISOString()}`,createdAt:new Date().toISOString()})).id,name:a}),getSnapshots:async e=>(await b(m(l,"patients",e,"snapshots"))).docs.map(s=>h(s)),deleteSnapshot:async(e,a)=>(await I(f(l,"patients",e,"snapshots",a)),{success:!0}),getAppointments:async()=>y.getOrFetch("appointments:all",async()=>{const e=A(m(l,"appointments"),O("date","desc"),L(100));return(await b(e)).docs.map(s=>h(s))},120*1e3),getAppointmentsByDateRange:async(e,a)=>{const s=`appointments:${e}:${a}`;return y.getOrFetch(s,async()=>{const r=A(m(l,"appointments"),E("date",">=",e),E("date","<=",a),O("date","asc"));return(await b(r)).docs.map(c=>h(c))},300*1e3)},getPatientAppointments:async e=>{const a=`appointments:patient:${e}`;return y.getOrFetch(a,async()=>{const s=A(m(l,"appointments"),E("patientId","==",e),O("date","desc"),L(20));return(await b(s)).docs.map(i=>h(i))},180*1e3)},createAppointment:async e=>{const a=`CITA-${Date.now()}`,s=await T(m(l,"appointments"),{...e,uniqueId:a,createdAt:new Date().toISOString()});return y.invalidatePattern("^appointments:"),{id:s.id,uniqueId:a,...e}},updateAppointment:async(e,a)=>{const s=f(l,"appointments",e);await D(s,a),y.invalidatePattern("^appointments:");const r=await w(s);return h(r)},deleteAppointment:async e=>{await I(f(l,"appointments",e)),y.invalidatePattern("^appointments:")},initiatePayment:async e=>{const{getFunctions:a,httpsCallable:s}=await R(async()=>{const{getFunctions:n,httpsCallable:u}=await import("./FloatingLabelInput-ByVDsq9z.js").then(p=>p.i);return{getFunctions:n,httpsCallable:u}},__vite__mapDeps([0,1,2,3,4,5,6])),r=a();return(await s(r,"initiatePayment")(e)).data},checkEmailAvailability:async e=>{const{getFunctions:a,httpsCallable:s}=await R(async()=>{const{getFunctions:n,httpsCallable:u}=await import("./FloatingLabelInput-ByVDsq9z.js").then(p=>p.i);return{getFunctions:n,httpsCallable:u}},__vite__mapDeps([0,1,2,3,4,5,6])),r=a();return(await s(r,"checkEmailAvailability")({email:e})).data},getUser:async e=>{const a=f(l,"users",e),s=await w(a);return s.exists()?h(s):null},setRole:async(e,a)=>{const s=f(l,"users",e),{setDoc:r}=await R(async()=>{const{setDoc:i}=await import("./firebase-CSuzTyKx.js").then(c=>c.Q);return{setDoc:i}},[]);return await r(s,{role:a,updatedAt:new Date().toISOString()},{merge:!0}),{success:!0}}},Te=e=>{if(!e)return"";const a=new Date(e),s=new Date;let r=s.getFullYear()-a.getFullYear(),i=s.getMonth()-a.getMonth(),c=s.getDate()-a.getDate();if((i<0||i===0&&c<0)&&(r--,i+=12),c<0){const n=new Date(s.getFullYear(),s.getMonth(),0);c+=n.getDate(),i--}return`${r} aÃ±os, ${i} meses, ${c} dÃ­as`},G="meet.jit.si",Oe=({isOpen:e,onClose:a,roomName:s,displayName:r,appointmentId:i})=>{const c=j.useRef(null),n=j.useRef(null),[u,p]=j.useState(!0),[o,d]=j.useState(null),[x,v]=j.useState(0),[N,P]=j.useState(!1),H=`HistoriaClinica${i.replace(/[^a-zA-Z0-9]/g,"")}`,Y=async()=>{try{if(p(!0),d(null),window.JitsiMeetExternalAPI||await new Promise((C,K)=>{const W=document.querySelector('script[src*="external_api.js"]');W&&W.remove();const _=document.createElement("script");_.src=`https://${G}/external_api.js`,_.async=!0,_.onload=()=>{console.log("Jitsi script loaded successfully"),C()},_.onerror=()=>K(new Error("No se pudo cargar el script de video")),document.head.appendChild(_)}),await new Promise(C=>setTimeout(C,300)),!c.current)throw new Error("Container not ready");n.current&&(n.current.dispose(),n.current=null),console.log("Creating Jitsi room:",H),n.current=new window.JitsiMeetExternalAPI(G,{roomName:H,parentNode:c.current,width:"100%",height:"100%",configOverwrite:{prejoinPageEnabled:!1,prejoinConfig:{enabled:!1},enableLobby:!1,hideLobbyButton:!0,startWithAudioMuted:!1,startWithVideoMuted:!1,disableDeepLinking:!0,enableWelcomePage:!1,enableClosePage:!1,disableInviteFunctions:!0,hideConferenceSubject:!1,subject:"Consulta MÃ©dica Virtual",enableInsecureRoomNameWarning:!1,requireDisplayName:!1,p2p:{enabled:!0},fileRecordingsEnabled:!1,liveStreamingEnabled:!1,breakoutRooms:{hideAddRoomButton:!0,hideAutoAssignButton:!0,hideJoinRoomButton:!0}},interfaceConfigOverwrite:{TOOLBAR_BUTTONS:["microphone","camera","desktop","fullscreen","hangup","chat","settings","videoquality","tileview","toggle-camera"],SHOW_JITSI_WATERMARK:!1,SHOW_WATERMARK_FOR_GUESTS:!1,SHOW_BRAND_WATERMARK:!1,BRAND_WATERMARK_LINK:"",DEFAULT_BACKGROUND:"#1a1a2e",DISABLE_JOIN_LEAVE_NOTIFICATIONS:!1,MOBILE_APP_PROMO:!1,HIDE_INVITE_MORE_HEADER:!0,DISABLE_FOCUS_INDICATOR:!0,SHOW_PROMOTIONAL_CLOSE_PAGE:!1,ENABLE_FEEDBACK_ANIMATION:!1,TOOLBAR_ALWAYS_VISIBLE:!1,INITIAL_TOOLBAR_TIMEOUT:15e3,TOOLBAR_TIMEOUT:4e3},userInfo:{displayName:r||"Participante"}}),console.log("JaaS API created, adding listeners..."),n.current.addListener("videoConferenceJoined",C=>{console.log("User joined video conference:",C),p(!1)}),n.current.addListener("videoConferenceLeft",()=>{console.log("User left video conference"),a()}),n.current.addListener("readyToClose",()=>{console.log("Ready to close"),a()}),setTimeout(()=>{p(!1)},5e3)}catch(C){console.error("JaaS initialization error:",C),d(C.message||"Error al iniciar la video consulta"),p(!1)}};j.useEffect(()=>{if(!e){n.current&&(n.current.dispose(),n.current=null),p(!0),d(null);return}return Y(),()=>{n.current&&(n.current.dispose(),n.current=null)}},[e,i,x]);const J=()=>{v(C=>C+1)},B=()=>{P(!N)};return e?t.jsx(q,{children:e&&t.jsxs($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black flex flex-col",children:[!N&&t.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gradient-to-r from-purple-900 to-indigo-900 border-b border-white/10",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-1.5 bg-white/10 rounded-lg",children:t.jsx(se,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-sm font-bold text-white",children:"Video Consulta"}),t.jsxs("p",{className:"text-[10px] text-purple-200",children:[r," â€¢ ID: ",H.slice(-8)]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:B,className:"p-1.5 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:"Pantalla completa",children:t.jsx(ie,{size:18})}),t.jsx("button",{onClick:a,className:"p-1.5 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors",children:t.jsx(k,{size:18})})]})]}),N&&t.jsxs("div",{className:"absolute top-2 right-2 z-30 flex gap-2",children:[t.jsx("button",{onClick:B,className:"p-2 bg-black/50 text-white hover:bg-black/70 rounded-lg transition-colors",children:t.jsx(re,{size:20})}),t.jsx("button",{onClick:a,className:"p-2 bg-red-500/80 text-white hover:bg-red-500 rounded-lg transition-colors",children:t.jsx(k,{size:20})})]}),t.jsxs("div",{className:"flex-1 relative bg-gray-900",children:[u&&!o&&t.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-b from-purple-900 to-indigo-900 z-20",children:[t.jsxs("div",{className:"relative mb-4",children:[t.jsx("div",{className:"w-14 h-14 border-4 border-white/20 rounded-full animate-pulse"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx(oe,{className:"w-7 h-7 text-white animate-bounce"})})]}),t.jsx("h3",{className:"text-base font-bold text-white mb-1",children:"Conectando..."}),t.jsx("p",{className:"text-purple-200 text-xs",children:"Iniciando video consulta"})]}),o&&t.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-b from-red-900 to-red-800 z-20",children:[t.jsx(ne,{className:"w-10 h-10 text-white mb-4"}),t.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Error de ConexiÃ³n"}),t.jsx("p",{className:"text-red-200 text-sm mb-4",children:o}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:J,className:"px-4 py-2 bg-white text-red-600 rounded-lg font-bold text-sm hover:bg-gray-100 transition-colors flex items-center gap-2",children:[t.jsx(ce,{size:16}),"Reintentar"]}),t.jsx("button",{onClick:a,className:"px-4 py-2 bg-white/20 text-white rounded-lg font-bold text-sm hover:bg-white/30 transition-colors",children:"Cerrar"})]})]}),t.jsx("div",{ref:c,className:"w-full h-full",style:{visibility:u||o?"hidden":"visible",position:"absolute",top:0,left:0,right:0,bottom:0}})]})]})}):null},xe=async(e,a)=>{let s=e;if(e.type.startsWith("image/"))try{s=await be(e)}catch(u){console.warn("Image compression failed, uploading original:",u)}const r=`${Date.now()}_${s.name}`,i=ee(X,`${a}/${r}`),c=await te(i,s);return await ae(c.ref)},Pe=async(e,a)=>xe(e,`profiles/${a}`),_e=e=>["image/jpeg","image/png","image/gif","image/webp"].includes(e.type),Re=(e,a=10)=>{const s=a*1024*1024;return e.size<=s},De=["Sangrado digestivo","Dificultad para tragar","Dolor al tragar","Dispepsia","Reflujo","Gastritis","Ulcera","Dolor abdominal","Hernia","Vomitos","Enfermedad de Crohn","Colitis","Ulcerativa","Colon irritable","Sindrome diarreico","Constipacion","Distension abdominal","Perdida de peso","Anemia","PÃ³lipos","CÃ¡ncer","Ictericia","Cirrosis hepÃ¡tica","Calculo en via biliar","Intolerancia alimenticia","Masa abdominal","Diverticulitis","Hemorroides","Fisura anal","Pancreatitis","Colecistitis","Obesidad","Hallazgo radiologico anormal","Dolor anal","Picazon anal","Pared abdominal"],Le=["MigraÃ±a","Epilepsia","Accidente cerebrovascular","Aneurisma","Parkinson","Alzheimer","Tumores","Accidente isquemico transitorio","Esclerosis multiple","Demencia","Traumatismo","Neuropatia","Autismo"],Me=["Obesidad","Colesterol y triglicÃ©ridos altos","Diabetes","Resistencia a la Insulina","Hipertiroidismo","Hipotiroidismo","Hipertension arterial"],ke=["Dermatitis","Psoriasis","Herpes","RosÃ¡cea","Eccema","Celulitis/Erisipela","Urticaria","Otros"],He=["Asma","EPOC","Tuberculosis","Fibrosis pulmonar","Apnea del sueÃ±o","Cancer de pulmon","Trombosis pulmonar","Infec. respiratorias sup","Bronquitis","Neumonia","Cancer de vias respiratorias"],Fe=["Hipertension arterial","Insuficiencia cardiaca","Infarto","Cardiopatia isquÃ©mica","Arritmias","Angina de pecho","Enfermedad valvular","Miocardiopatia","Cardiopatias congenita","Endocarditis"],ze=["Trastorno motor esofagico","Sangrado digestivo","Dispepsia","Reflujo","Gastritis","Ulcera","Enfermedad de Crohn","Colitis Ulcerativa","Colon irritable","Diarrea cronica","Constipacion cronica","PÃ³lipos","CÃ¡ncer","Intolerancia alimenticia","Disfagia neurogenica","Enfermedad diverticular","Hemorroides","Fisura anal","Fistula anal","Acalasia","SÃ­ndrome de malabsorciÃ³n"],qe=["Higado graso","Hepatitis","Cirrosis","Cancer higado","Hemocromatosis","Litiasis vesicular","Litiasis de la via biliar","Colangitis esclerosante primaria","Pancreatitis","CÃ¡ncer","VÃ¡rices","Ictericia"],$e=["Insuficiencia venosa","Varices","Trombosis venosa superficial","Trombosis venosa profunda","ObstrucciÃ³n arterial aguda o crÃ³nica","Aneurisma","Enfermedad carotidea"],Be=["Sangrados o hematomas frecuentes","Leucemia","Linfomas","Mieloma","Anemia","Hemofilia","PÃºrpura trombocitopÃ©nica idiopÃ¡tica","Trombofilia","Neutropenia","Sindrome mileodisplasico","Policitemia vera","Plaquetopenia","Trombocitosis"],We=["Insuficiencia renal","Calculos","CÃ¡ncer","Infecciones a repeticion","Enfermedad renal diabÃ©tica","Enfermedad renal hipertensiva","Pielonefritis","Enfermedad quÃ­stica","Transplantado renal","Hiperplasia prostÃ¡tica benigna"],Ue=["Lupus","Artritis","Artrosis","Esclerodermia","Fibromialgia","Gota","Osteoporosis","Polimialgia","Polimiositis","Esclerosis multiple","Sarcoidosis","Sd Antifosfolipidos","Vasculitis","Sindrome de Sjogren"],Ge=["Malaria","VIH","Dengue","Sarampion","Hepatitis","Covid","Amigdalitis","ETS","Herpes","Parasitosis","Neumonia"],Ve=["Ansiedad","Depresion","Esquizofrenia","Trastorno bipolar","Ataques de panico","Intento de suicidio","Fobias","Alzheimer","Trastorno obsesivo compulsivo","Anorexia","Bulimia","TDAH"],Ye=["Miomas","Quistes de ovario","Endometriosis","Aborto","Preeclampsia","Infecciones vaginales","Eclampsia","Prolapso genital","Diabetes gestacional","CÃ¡ncer","SÃ­ndrome de ovario poliquÃ­stico","Embarazo ectÃ³pico","Infertilidad","Trastornos hormonales","Otros"],Je=["Endometriosis","Miomas","Cancer cervicouterino","Prolapso uterino","Quistes de ovarios","Ovario poliquÃ­stico","Hemorragia disfuncional","Infecciones ginecologicas"],Ke=["Analgesicos","AntibiÃ³ticos","Protectores gÃ¡stricos","Antihipertensivos","Hipoglicemiantes","AntiarrÃ­tmicos","Anticoagulantes","Aspirina","Antigagregantes plaquetarios","Antiulcerosos","AntiÃ¡cidos","Antidepresivos","Antisicoticos","Ansioliticos"],Qe=["Medicamentos","Yodo","Latex","Anestesicos","Transfusiones sanguineas","Medio de contraste"],Xe=["Leche","Mariscos","Huevo","Pescado","ManÃ­","Soja","Trigo","Frutos secos"],Ze=["Gluten","Lactosa","Fructosa","Histamina","Sorbitol","Salicilatos","Sacarosa"],et=["Tabaquismo","Alcohol","Drogas","Cafeina","Psicofarmacos","Vaping","Medicamentos controlados"],tt=["Quimicos","Derivados del petroleo","Radiaciones","Mineria","Aserrin","Plomo","Pinturas","Venenos","Fertilizantes","Hierro y acero","Caucho","Aluminio","Derivados el alcohol"],at=["Cancer","Hipertiroidismo","Hipotiroidismo","Colitis ulcerativa","E. Crohn","Poliposis","Diabetes","Hipertension","Cardiopatia isquemica","Asma","EPOC","Epilepsia","Enf. Autoinmune"],st=["Colitis Ulcerativa","Enfermedad de Crohn","SÃ­ndrome polipÃ³sico","Cancer digestivo","Enfermedades autoinmunes digestivas"],we=["Piel y anexos","Cabeza","Cuello","Torax","Cardiaco","Pulmonar","Abdomen","Miembros superiores","Miembros inferiores","Neurologico","Genitales","Tacto Rectal"],ye="flex items-center space-x-3 p-2.5 rounded-lg border-2 border-gray-900 bg-white hover:bg-gray-50 transition-all cursor-pointer",ve="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",it=({items:e,data:a,onChange:s})=>t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 text-sm",children:e.map(r=>{const i=!!a[r];return t.jsxs("label",{className:`${ye} ${i?"bg-blue-50 border-blue-100":""}`,children:[t.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${i?"bg-blue-600 border-gray-900":"bg-white border-gray-900"}`,children:i&&t.jsx(le,{size:12,className:"text-white"})}),t.jsx("input",{type:"checkbox",checked:i,onChange:c=>s(r,c.target.checked),className:"hidden"}),t.jsx("span",{className:`font-medium ${i?"text-blue-800":"text-gray-600"}`,children:r})]},r)})}),F=({label:e,checked:a,onClick:s})=>t.jsx("button",{type:"button",onClick:s,className:`px-4 py-1.5 rounded-full text-sm font-semibold transition-all shadow-sm ${a?"bg-blue-600 text-white ring-2 ring-blue-200":"bg-white text-gray-500 border-2 border-gray-900 hover:bg-gray-50"}`,children:e}),S=({label:e,value:a,onChange:s})=>t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between py-4 border-b border-gray-100 last:border-0 gap-3",children:[t.jsx("span",{className:"font-medium text-black",children:e}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(F,{label:"SI",checked:a.yes,onClick:()=>s("yes",!a.yes)}),t.jsx(F,{label:"NO",checked:a.no,onClick:()=>s("no",!a.no)}),a.na!==void 0&&t.jsx(F,{label:"N/A",checked:a.na,onClick:()=>s("na",!a.na)})]})]}),rt=({data:e,onChange:a})=>{const s=(r,i,c)=>{a({...e,systems:{...e.systems,[r]:{...e.systems[r],[i]:c}}})};return t.jsxs("div",{className:"space-y-6 bg-white p-6 rounded-xl border border-gray-200 shadow-sm relative overflow-hidden",children:[t.jsx("h3",{className:ve,children:"V. Examen FÃ­sico"}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-9 gap-4 text-sm mb-8",children:["fc","fr","temp","pa","pam","sat02","weight","height","imc"].map(r=>t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-gray-500 text-[11px] uppercase font-bold mb-1.5 tracking-wider",children:r}),t.jsx("input",{className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 text-gray-800 text-sm rounded-lg shadow-sm focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition-all outline-none text-center font-medium font-mono",value:e[r],onChange:i=>a({...e,[r]:i.target.value})})]},r))}),t.jsx("div",{className:"glass rounded-2xl overflow-hidden border border-white/20 shadow-lg",children:t.jsxs("table",{className:"w-full text-sm text-left",children:[t.jsx("thead",{className:"bg-[#154c8a]/5 text-[#154c8a] uppercase text-xs backdrop-blur-sm",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-4 font-bold tracking-wide",children:"Organos y Sistemas"}),t.jsx("th",{className:"p-4 text-center font-bold w-24",children:"Normal"}),t.jsx("th",{className:"p-4 text-center font-bold w-24",children:"Anormal"}),t.jsx("th",{className:"p-4 font-bold",children:"DescripciÃ³n"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-100/50",children:we.map(r=>{var i,c,n;return t.jsxs("tr",{className:"hover:bg-white/40 transition-colors duration-200",children:[t.jsx("td",{className:"p-4 font-medium text-gray-700",children:r}),t.jsx("td",{className:"p-4 text-center",children:t.jsx("div",{className:"flex justify-center",children:t.jsx("input",{type:"checkbox",className:"w-5 h-5 appearance-none border border-gray-300 rounded-md checked:bg-[#154c8a] checked:border-[#154c8a] transition-all cursor-pointer relative after:content-[''] after:absolute after:hidden checked:after:block after:left-[6px] after:top-[2px] after:w-[6px] after:h-[10px] after:border-white after:border-r-2 after:border-b-2 after:rotate-45 shadow-sm",checked:((i=e.systems[r])==null?void 0:i.normal)||!1,onChange:u=>s(r,"normal",u.target.checked)})})}),t.jsx("td",{className:"p-4 text-center",children:t.jsx("div",{className:"flex justify-center",children:t.jsx("input",{type:"checkbox",className:"w-5 h-5 appearance-none border border-gray-300 rounded-md checked:bg-red-500 checked:border-red-500 transition-all cursor-pointer relative after:content-[''] after:absolute after:hidden checked:after:block after:left-[6px] after:top-[2px] after:w-[6px] after:h-[10px] after:border-white after:border-r-2 after:border-b-2 after:rotate-45 shadow-sm",checked:((c=e.systems[r])==null?void 0:c.abnormal)||!1,onChange:u=>s(r,"abnormal",u.target.checked)})})}),t.jsx("td",{className:"p-4",children:t.jsx("input",{className:"w-full bg-transparent border-b border-gray-300 focus:border-[#154c8a] focus:outline-none text-gray-700 placeholder-gray-400 py-1 transition-colors",placeholder:"Describir hallazgos...",value:((n=e.systems[r])==null?void 0:n.description)||"",onChange:u=>s(r,"description",u.target.value)})})]},r)})})]})})]})},V={weightGainOnset:{childhood:!1,youth:!1,pregnancy:!1,menopause:!1,postEvent:!1,when:""},familyObesity:{yes:!1,no:!1,who:""},familyPathologies:{yes:!1,no:!1,who:""},previousTreatments:{yes:!1,no:!1,which:""},previousMeds:{yes:!1,no:!1,which:""},maxWeight:"",minWeight:"",reboundCause:"",previousActivity:{yes:!1,no:!1,which:""},currentActivity:{yes:!1,no:!1,which:""},qualityOfLifeAlteration:{yes:!1,no:!1,how:""},metrics:{height:"",currentWeight:"",currentImc:"",lostWeight:"",lostOverweightPercentage:"",lostImcExcessPercentage:"",desiredWeight:"",desiredImc:""}},ot=({isOpen:e,onClose:a,onSave:s,initialData:r})=>{const[i,c]=j.useState(V);j.useEffect(()=>{if(e){const o=r&&Object.keys(r).length>0&&r.weightGainOnset;c(o?r:V)}},[e,r]);const n=(o,d)=>{c(x=>({...x,[o]:d}))},u=(o,d,x)=>{c(v=>{const P={...v[o],[d]:x};return x&&(d==="yes"&&(P.no=!1),d==="no"&&(P.yes=!1)),{...v,[o]:P}})},p=()=>{s(i)};return e?t.jsx(q,{children:t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:t.jsxs($.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Historia de Obesidad"}),t.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-200 rounded-full transition-colors",children:t.jsx(k,{size:24,className:"text-gray-500"})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-8 space-y-8",children:[t.jsxs("section",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Inicio de ganancia de peso"}),t.jsx("div",{className:"flex flex-wrap gap-4 mb-4",children:["NiÃ±ez","Juventud","Embarazo","Menopausia","Post evento"].map(o=>{const d=o==="NiÃ±ez"?"childhood":o==="Juventud"?"youth":o==="Embarazo"?"pregnancy":o==="Menopausia"?"menopause":"postEvent";return t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:i.weightGainOnset[d],onChange:x=>n("weightGainOnset",{...i.weightGainOnset,[d]:x.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.jsx("span",{className:"text-gray-700",children:o})]},d)})}),t.jsx(g,{label:"Â¿CuÃ¡ndo?",value:i.weightGainOnset.when,onChange:o=>n("weightGainOnset",{...i.weightGainOnset,when:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})]}),t.jsxs("div",{className:"border-t-2 border-gray-900 pt-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx(S,{label:"Antecedente de Obesidad en familiares en primer grado",value:i.familyObesity,onChange:(o,d)=>u("familyObesity",o,d)}),i.familyObesity.yes&&t.jsx("div",{className:"mt-4",children:t.jsx(g,{label:"Â¿QuiÃ©n?",value:i.familyObesity.who,onChange:o=>n("familyObesity",{...i.familyObesity,who:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})})]}),t.jsxs("div",{children:[t.jsx(S,{label:"Antecedentes patolÃ³gicos en familiares en primer grado",value:i.familyPathologies,onChange:(o,d)=>u("familyPathologies",o,d)}),i.familyPathologies.yes&&t.jsx("div",{className:"mt-4",children:t.jsx(g,{label:"Â¿QuiÃ©n?",value:i.familyPathologies.who,onChange:o=>n("familyPathologies",{...i.familyPathologies,who:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})})]}),t.jsxs("div",{children:[t.jsx(S,{label:"Tratamientos previos para bajar de peso",value:i.previousTreatments,onChange:(o,d)=>u("previousTreatments",o,d)}),i.previousTreatments.yes&&t.jsx("div",{className:"mt-4",children:t.jsx(g,{label:"Â¿CuÃ¡l?",value:i.previousTreatments.which,onChange:o=>n("previousTreatments",{...i.previousTreatments,which:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})})]}),t.jsxs("div",{children:[t.jsx(S,{label:"Medicamentos, suplementos nutricionales previos",value:i.previousMeds,onChange:(o,d)=>u("previousMeds",o,d)}),i.previousMeds.yes&&t.jsx("div",{className:"mt-4",children:t.jsx(g,{label:"Â¿CuÃ¡les?",value:i.previousMeds.which,onChange:o=>n("previousMeds",{...i.previousMeds,which:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 border-t-2 border-gray-900 pt-6",children:[t.jsx(g,{label:"Peso mÃ¡ximo alcanzado (kg)",value:i.maxWeight,onChange:o=>n("maxWeight",o.target.value),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"}),t.jsx(g,{label:"Peso mÃ­nimo alcanzado (kg)",value:i.minWeight,onChange:o=>n("minWeight",o.target.value),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})]}),t.jsx(g,{label:"Causa de rebote",value:i.reboundCause,onChange:o=>n("reboundCause",o.target.value),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"}),t.jsxs("div",{className:"border-t-2 border-gray-900 pt-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx(S,{label:"Actividad fÃ­sica previa",value:i.previousActivity,onChange:(o,d)=>u("previousActivity",o,d)}),i.previousActivity.yes&&t.jsx("div",{className:"mt-4",children:t.jsx(g,{label:"Â¿CuÃ¡l?",value:i.previousActivity.which,onChange:o=>n("previousActivity",{...i.previousActivity,which:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})})]}),t.jsxs("div",{children:[t.jsx(S,{label:"Actividad fÃ­sica actual",value:i.currentActivity,onChange:(o,d)=>u("currentActivity",o,d)}),i.currentActivity.yes&&t.jsx("div",{className:"mt-4",children:t.jsx(g,{label:"Â¿CuÃ¡l?",value:i.currentActivity.which,onChange:o=>n("currentActivity",{...i.currentActivity,which:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})})]}),t.jsxs("div",{children:[t.jsx(S,{label:"AlteraciÃ³n de calidad de vida y laboral",value:i.qualityOfLifeAlteration,onChange:(o,d)=>u("qualityOfLifeAlteration",o,d)}),i.qualityOfLifeAlteration.yes&&t.jsx("div",{className:"mt-4",children:t.jsx(g,{label:"Â¿CÃ³mo?",value:i.qualityOfLifeAlteration.how,onChange:o=>n("qualityOfLifeAlteration",{...i.qualityOfLifeAlteration,how:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})})]})]}),t.jsxs("div",{className:"border-t-2 border-gray-900 pt-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx(g,{label:"Talla (cm)",value:i.metrics.height,onChange:o=>n("metrics",{...i.metrics,height:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"}),t.jsx(g,{label:"Peso actual (kg)",value:i.metrics.currentWeight,onChange:o=>n("metrics",{...i.metrics,currentWeight:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"}),t.jsx(g,{label:"IMC actual",value:i.metrics.currentImc,onChange:o=>n("metrics",{...i.metrics,currentImc:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"}),t.jsx(g,{label:"Peso perdido",value:i.metrics.lostWeight,onChange:o=>n("metrics",{...i.metrics,lostWeight:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"}),t.jsx(g,{label:"% sobrepeso perdido",value:i.metrics.lostOverweightPercentage,onChange:o=>n("metrics",{...i.metrics,lostOverweightPercentage:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"}),t.jsx(g,{label:"% perdido exceso IMC",value:i.metrics.lostImcExcessPercentage,onChange:o=>n("metrics",{...i.metrics,lostImcExcessPercentage:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"}),t.jsx(g,{label:"Peso deseado (Kg)",value:i.metrics.desiredWeight,onChange:o=>n("metrics",{...i.metrics,desiredWeight:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"}),t.jsx(g,{label:"IMC deseado",value:i.metrics.desiredImc,onChange:o=>n("metrics",{...i.metrics,desiredImc:o.target.value}),wrapperClassName:"bg-white border-2 border-gray-900 rounded-xl"})]})]}),t.jsx("div",{className:"p-6 border-t border-gray-100 bg-gray-50 flex justify-end",children:t.jsxs("button",{onClick:p,className:"bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 flex items-center gap-2 shadow-lg shadow-blue-600/20 transition-all transform hover:scale-[1.02] active:scale-[0.98]",children:[t.jsx(de,{size:20})," Agregar"]})})]})})}):null},nt=({message:e,type:a,isVisible:s,onClose:r})=>(j.useEffect(()=>{if(s){const i=setTimeout(()=>{r()},4e3);return()=>clearTimeout(i)}},[s,r]),t.jsx(q,{children:s&&t.jsxs($.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:`fixed bottom-6 right-6 z-[100] flex items-center gap-3 px-6 py-4 rounded-xl shadow-2xl backdrop-blur-md border ${a==="success"?"bg-green-600/90 border-green-500 text-white":"bg-red-600/90 border-red-500 text-white"}`,children:[t.jsx("div",{className:`p-1 rounded-full ${a==="success"?"bg-green-500":"bg-red-500"}`,children:a==="success"?t.jsx(ue,{size:20}):t.jsx(me,{size:20})}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"font-bold text-sm",children:a==="success"?"Ã‰xito":"Error"}),t.jsx("span",{className:"text-sm opacity-90 font-medium",children:e})]}),t.jsx("button",{onClick:r,className:"ml-4 p-1 hover:bg-white/20 rounded-full transition-colors",children:t.jsx(k,{size:16})})]})}));export{Qe as A,it as C,ke as D,tt as E,Ze as F,ze as G,qe as H,Ge as I,Oe as J,De as M,Le as N,ot as O,$e as P,He as R,we as S,nt as T,S as Y,Se as a,Me as b,Te as c,Fe as d,Be as e,We as f,Ue as g,Ve as h,_e as i,Ye as j,Je as k,et as l,at as m,rt as n,Ke as o,Xe as p,st as q,Ee as r,Pe as u,Re as v};
