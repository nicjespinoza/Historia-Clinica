import{j as e,u as g,v as j,w as p}from"./ui-BmRGmjZq.js";import{b as f,a as y,r as l}from"./vendor-DTmQ9CDn.js";import{a as x}from"./Toast-CnzM179m.js";import"./index-BUr3TCdC.js";import"./firebase-BYKe8LDu.js";import"./FloatingLabelInput-yKyd0NR2.js";import"./utils-CDN07tui.js";const a=({label:i,value:t})=>{if(!t)return null;let r=t;return typeof t=="object"&&(t.list?r=t.list:t.conditions?r=Object.keys(t.conditions).filter(o=>t.conditions[o]).join(", "):t.yes!==void 0?r=t.yes?t.description||t.which||t.list||"Sí":"No":r=JSON.stringify(t)),r==="No"||r===""?null:e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsx("h4",{className:"font-bold text-gray-700 text-sm uppercase mb-1",children:i}),e.jsx("p",{className:"text-gray-800 whitespace-pre-wrap",children:String(r)})]})},O=()=>{const{patientId:i}=f(),t=y(),[r,o]=l.useState(null),[s,m]=l.useState(null),[b,h]=l.useState(!0);return l.useEffect(()=>{(async()=>{if(i)try{const[n,c]=await Promise.all([x.getPatient(i),x.getHistories(i)]);o(n),c&&c.length>0&&m(c[0])}catch(n){console.error(n)}finally{h(!1)}})()},[i]),b?e.jsx("div",{className:"p-8 text-center",children:"Cargando datos históricos..."}):r?e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>t(`/app/profile/${r.id}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 font-bold bg-white px-4 py-2 rounded-xl shadow-sm border border-gray-200",children:[e.jsx(g,{size:20}),"Volver al Perfil"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Historia Clínica (Migrada)"}),e.jsxs("p",{className:"text-gray-500",children:[r.firstName," ",r.lastName]})]})]}),s?e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 bg-[#084286] text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{size:24}),e.jsx("h2",{className:"text-lg font-bold",children:"Datos Históricos (Solo Lectura)"})]})}),e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#084286] mb-4 border-b pb-2",children:"Motivo de Consulta"}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl text-blue-900 font-medium",children:[Array.isArray(s.motives)?s.motives.join(", "):typeof s.motives=="object"?Object.keys(s.motives).filter(d=>s.motives[d]).join(", "):JSON.stringify(s.motives),s.otherMotive&&e.jsxs("span",{className:"block mt-1 text-sm text-blue-700",children:["Otros: ",s.otherMotive]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-bold text-gray-700 text-sm",children:"Historia de la Enfermedad Actual"}),e.jsx("p",{className:"text-gray-800 mt-1 p-3 bg-gray-50 rounded-lg border border-gray-100",children:s.historyOfPresentIllness||"No registrado"})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#084286] mb-4 border-b pb-2",children:"Antecedentes Patológicos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(a,{label:"Neurológicos",value:s.neurological}),e.jsx(a,{label:"Metabólicos",value:s.metabolic}),e.jsx(a,{label:"Cardíacos",value:s.cardiac}),e.jsx(a,{label:"Respiratorios",value:s.respiratory}),e.jsx(a,{label:"Gastrointestinales",value:s.gastro}),e.jsx(a,{label:"Renales",value:s.renal}),e.jsx(a,{label:"Reumatológicos",value:s.rheumatological}),e.jsx(a,{label:"Infecciosos",value:s.infectious}),e.jsx(a,{label:"Alergias",value:s.allergies}),e.jsx(a,{label:"Cirugías",value:s.surgeries})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#084286] mb-4 border-b pb-2",children:"Gineco-Obstétricos (Mujer)"}),e.jsx(a,{label:"Datos Ginecobstétricos",value:s.gyneco})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#084286] mb-4 border-b pb-2",children:"Diagnóstico y Tratamiento"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-bold text-gray-700 text-sm",children:"Diagnóstico"}),e.jsx("p",{className:"text-gray-800 mt-1 p-3 bg-gray-50 rounded-lg border border-gray-100 whitespace-pre-line",children:s.diagnosis||"No registrado"})]})]})]})]}):e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm text-center",children:[e.jsx(j,{className:"mx-auto text-yellow-500 mb-4",size:48}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"No se encontró historia clínica"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Este paciente parece tener datos migrados pero no se encontró la colección de historia clínica correspondiente."})]})]})}):e.jsx("div",{className:"p-8 text-center",children:"Paciente no encontrado"})};export{O as LegacyHistoryScreen,O as default};
