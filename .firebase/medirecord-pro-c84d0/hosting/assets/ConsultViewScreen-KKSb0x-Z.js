import{j as e,v as L,P as R,e as F,y as H,z as V,D as _}from"./ui-DQFPLK17.js";import{b as $,a as G,r as l}from"./vendor-CGaW2js3.js";import{a as z}from"./index-CVM7lhyd.js";import"./firebase-BCTgdpS7.js";const K=()=>{var b,j,f,N,y,v,w,C,E,S;const{patientId:c,consultId:d}=$(),x=G(),[r,A]=l.useState(null),[t,D]=l.useState(null),[k,h]=l.useState(!0),[p,g]=l.useState(null),I=s=>{const a={...s};return a.historyOfPresentIllness||(a.historyOfPresentIllness=s.evolutionNotes||s.reason||""),s.treatment&&(a.treatment||(a.treatment={}),!a.treatment.meds&&s.treatment.medications&&(a.treatment.meds=s.treatment.medications),!a.treatment.norms&&s.treatment.instructions&&(a.treatment.norms=Array.isArray(s.treatment.instructions)?s.treatment.instructions:[s.treatment.instructions])),s.vitalSigns&&!a.physicalExam&&(a.physicalExam={pa:s.vitalSigns.bloodPressure,fc:s.vitalSigns.heartRate,temp:s.vitalSigns.temperature,weight:s.vitalSigns.weight,talla:s.vitalSigns.height}),a};l.useEffect(()=>{(async()=>{if(!(!c||!d))try{h(!0);const a=await z.getPatient(c);A(a);const i=await z.getConsult(c,d);i?D(I(i)):g("Consulta no encontrada.")}catch(a){console.error("Error loading data:",a),g("Error al cargar la información.")}finally{h(!1)}})()},[c,d]);const u=s=>{if(!s)return"Sin fecha";try{return new Date(s).toLocaleDateString("es-NI",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return s}},M=s=>{var P;const a=((P=s.physicalExam)==null?void 0:P.systems)||{},i=Object.entries(a).filter(([o,n])=>n.abnormal||n.description);if(i.length===0)return null;const T={piel:"Piel",cabeza:"Cabeza",cuello:"Cuello",torax:"Tórax",cardiaco:"Cardíaco",pulmonar:"Pulmonar",abdomen:"Abdomen",miembrosuper:"Miembros Sup.",miembroinfe:"Miembros Inf.",neuro:"Neurológico",genitales:"Genitales",tacto:"Tacto Rectal"};return e.jsxs("div",{className:"mt-4 break-inside-avoid",children:[e.jsxs("h4",{className:"text-sm font-bold text-gray-600 uppercase mb-2 flex items-center gap-2",children:[e.jsx(_,{size:16})," Examen Físico (Hallazgos)"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:i.map(([o,n])=>e.jsxs("div",{className:`p-2 rounded-lg text-xs ${n.abnormal?"bg-red-50 text-red-700":"bg-gray-50 text-gray-600"}`,children:[e.jsxs("span",{className:"font-bold",children:[T[o]||o,":"]})," ",n.abnormal?"Anormal":"Normal",n.description&&e.jsx("span",{className:"block text-[10px] opacity-80 mt-1",children:n.description})]},o))})]})};if(k)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"text-[#083c79] font-bold animate-pulse",children:"Cargando consulta..."})});if(p||!t)return e.jsxs("div",{className:"p-8 text-center min-h-screen flex flex-col items-center justify-center",children:[e.jsx("p",{className:"text-red-600 font-bold mb-4",children:p||"Error desconocido"}),e.jsx("button",{onClick:()=>x(-1),className:"px-4 py-2 bg-gray-200 rounded text-gray-700 font-bold hover:bg-gray-300",children:"Volver"})]});const m=s=>Array.isArray(s)?s.join(", "):s,O=s=>s?Object.entries(s).filter(([a,i])=>i).map(([a])=>a).join(", "):"";return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20 font-sans",children:[e.jsx("div",{className:"bg-white border-b sticky top-0 z-50 print:hidden shadow-sm",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>x(-1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-600",children:e.jsx(L,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-[#083c79]",children:"Detalle de Consulta"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName," • ",u(t.date)]})]})]}),e.jsxs("button",{onClick:()=>window.print(),className:"flex items-center gap-2 bg-[#083c79] text-white px-4 py-2 rounded-lg font-bold hover:bg-blue-800 transition-colors shadow-lg shadow-blue-900/10",children:[e.jsx(R,{size:18})," Imprimir"]})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto bg-white shadow-xl my-8 p-8 md:p-12 min-h-[29.7cm] print:shadow-none print:my-0 print:p-0 print:w-full",children:[e.jsxs("div",{className:"border-b-4 border-[#083c79] pb-4 mb-8 flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-extrabold text-[#083c79] tracking-tight mb-1",children:"CONSULTA MÉDICA"}),e.jsxs("div",{className:"text-sm font-medium text-gray-500",children:["Fecha: ",u(t.date)," | Hora: ",t.time]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["ID: ",(r==null?void 0:r.legacyIdSistema)||(r==null?void 0:r.id)]})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-blue-50/50 p-4 rounded-xl border border-blue-100 break-inside-avoid",children:[e.jsxs("h3",{className:"text-xs font-bold text-blue-800 uppercase mb-3 flex items-center gap-2",children:[e.jsx(F,{size:14})," Signos Vitales"]}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-4 text-center",children:[{l:"FC",v:(b=t.physicalExam)==null?void 0:b.fc},{l:"FR",v:(j=t.physicalExam)==null?void 0:j.fr},{l:"Temp",v:(f=t.physicalExam)==null?void 0:f.temp,u:"°C"},{l:"PA",v:(N=t.physicalExam)==null?void 0:N.pa},{l:"SatO2",v:(y=t.physicalExam)==null?void 0:y.sat02,u:"%"},{l:"Peso",v:(v=t.physicalExam)==null?void 0:v.weight,u:"lb"}].map((s,a)=>e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase",children:s.l}),e.jsxs("p",{className:"font-bold text-[#083c79] text-lg",children:[s.v||"--"," ",e.jsx("span",{className:"text-xs font-normal text-gray-400",children:s.u})]})]},a))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_2fr] gap-8",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-[#083c79] text-sm uppercase block mb-1",children:"Motivo de Consulta"}),e.jsxs("p",{className:"text-gray-900 font-medium",children:[O(t.motives),t.otherMotive&&(t.motives?`, ${t.otherMotive}`:t.otherMotive)]}),t.evolutionTime&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[e.jsx("span",{className:"font-bold",children:"Evolución:"})," ",t.evolutionTime]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-[#083c79] text-sm uppercase block mb-1",children:"Historia de la enfermedad actual"}),e.jsx("p",{className:"text-gray-900 text-sm textual-justify leading-relaxed whitespace-pre-line",children:t.historyOfPresentIllness||"Sin descripción."})]})]}),M(t),e.jsxs("div",{className:"bg-green-50/50 p-6 rounded-xl border border-green-100 break-inside-avoid",children:[e.jsxs("h3",{className:"text-sm font-bold text-green-800 uppercase mb-2 flex items-center gap-2",children:[e.jsx(H,{size:16})," Diagnóstico"]}),t.diagnoses&&t.diagnoses.length>0?e.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.diagnoses.map((s,a)=>s&&e.jsx("li",{className:"text-green-900 font-medium",children:s},a))}):e.jsx("p",{className:"text-gray-400 italic text-sm",children:"No registrado"})]}),e.jsxs("div",{className:"break-inside-avoid",children:[e.jsx("h3",{className:"text-sm font-bold text-white bg-[#083c79] px-3 py-1.5 rounded-t inline-block uppercase tracking-wide",children:"Plan y Tratamiento"}),e.jsxs("div",{className:"border border-gray-200 rounded-b-lg rounded-tr-lg p-6 bg-white shadow-sm space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-purple-700 uppercase mb-2 flex items-center gap-2",children:[e.jsx(V,{size:14})," Medicamentos"]}),e.jsx("div",{className:"bg-purple-50 p-3 rounded-lg text-sm text-gray-800 whitespace-pre-line",children:m((w=t.treatment)==null?void 0:w.meds)||"Ninguno"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-yellow-700 uppercase mb-2",children:"Alimentación / Dieta"}),e.jsx("div",{className:"bg-yellow-50 p-3 rounded-lg text-sm text-gray-800 whitespace-pre-line",children:((C=t.treatment)==null?void 0:C.food)||"Ninguna indicación"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-blue-700 uppercase mb-2",children:"Exámenes Solicitados"}),e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg text-sm text-gray-800 whitespace-pre-line",children:m((E=t.treatment)==null?void 0:E.exams)||"Ninguno"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-700 uppercase mb-2",children:"Recomendaciones / Normas"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg text-sm text-gray-800 whitespace-pre-line",children:m((S=t.treatment)==null?void 0:S.norms)||"Ninguna"})]})]})]})]}),t.comments&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("span",{className:"font-bold text-gray-400 text-xs uppercase",children:"Comentarios Adicionales"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1 italic",children:t.comments})]})]})]})]})};export{K as ConsultViewScreen};
