import{j as e,v as g,w as j,x as p}from"./ui-DQFPLK17.js";import{b as f,a as y,r as l}from"./vendor-CGaW2js3.js";import{a as x}from"./index-CVM7lhyd.js";import"./firebase-BCTgdpS7.js";const r=({label:i,value:t})=>{if(!t)return null;let a=t;return typeof t=="object"&&(t.list?a=t.list:t.conditions?a=Object.keys(t.conditions).filter(o=>t.conditions[o]).join(", "):t.yes!==void 0?a=t.yes?t.description||t.which||t.list||"Sí":"No":a=JSON.stringify(t)),a==="No"||a===""?null:e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsx("h4",{className:"font-bold text-gray-700 text-sm uppercase mb-1",children:i}),e.jsx("p",{className:"text-gray-800 whitespace-pre-wrap",children:String(a)})]})},S=()=>{const{patientId:i}=f(),t=y(),[a,o]=l.useState(null),[s,m]=l.useState(null),[b,h]=l.useState(!0);return l.useEffect(()=>{(async()=>{if(i)try{const[n,c]=await Promise.all([x.getPatient(i),x.getHistories(i)]);o(n),c&&c.length>0&&m(c[0])}catch(n){console.error(n)}finally{h(!1)}})()},[i]),b?e.jsx("div",{className:"p-8 text-center",children:"Cargando datos históricos..."}):a?e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>t(`/app/profile/${a.id}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 font-bold bg-white px-4 py-2 rounded-xl shadow-sm border border-gray-200",children:[e.jsx(g,{size:20}),"Volver al Perfil"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Historia Clínica (Migrada)"}),e.jsxs("p",{className:"text-gray-500",children:[a.firstName," ",a.lastName]})]})]}),s?e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 bg-[#084286] text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{size:24}),e.jsx("h2",{className:"text-lg font-bold",children:"Datos Históricos (Solo Lectura)"})]})}),e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#084286] mb-4 border-b pb-2",children:"Motivo de Consulta"}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl text-blue-900 font-medium",children:[Array.isArray(s.motives)?s.motives.join(", "):typeof s.motives=="object"?Object.keys(s.motives).filter(d=>s.motives[d]).join(", "):JSON.stringify(s.motives),s.otherMotive&&e.jsxs("span",{className:"block mt-1 text-sm text-blue-700",children:["Otros: ",s.otherMotive]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-bold text-gray-700 text-sm",children:"Historia de la Enfermedad Actual"}),e.jsx("p",{className:"text-gray-800 mt-1 p-3 bg-gray-50 rounded-lg border border-gray-100",children:s.historyOfPresentIllness||"No registrado"})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#084286] mb-4 border-b pb-2",children:"Antecedentes Patológicos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(r,{label:"Neurológicos",value:s.neurological}),e.jsx(r,{label:"Metabólicos",value:s.metabolic}),e.jsx(r,{label:"Cardíacos",value:s.cardiac}),e.jsx(r,{label:"Respiratorios",value:s.respiratory}),e.jsx(r,{label:"Gastrointestinales",value:s.gastro}),e.jsx(r,{label:"Renales",value:s.renal}),e.jsx(r,{label:"Reumatológicos",value:s.rheumatological}),e.jsx(r,{label:"Infecciosos",value:s.infectious}),e.jsx(r,{label:"Alergias",value:s.allergies}),e.jsx(r,{label:"Cirugías",value:s.surgeries})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#084286] mb-4 border-b pb-2",children:"Gineco-Obstétricos (Mujer)"}),e.jsx(r,{label:"Datos Ginecobstétricos",value:s.gyneco})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#084286] mb-4 border-b pb-2",children:"Diagnóstico y Tratamiento"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-bold text-gray-700 text-sm",children:"Diagnóstico"}),e.jsx("p",{className:"text-gray-800 mt-1 p-3 bg-gray-50 rounded-lg border border-gray-100 whitespace-pre-line",children:s.diagnosis||"No registrado"})]})]})]})]}):e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm text-center",children:[e.jsx(j,{className:"mx-auto text-yellow-500 mb-4",size:48}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"No se encontró historia clínica"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Este paciente parece tener datos migrados pero no se encontró la colección de historia clínica correspondiente."})]})]})}):e.jsx("div",{className:"p-8 text-center",children:"Paciente no encontrado"})};export{S as LegacyHistoryScreen,S as default};
